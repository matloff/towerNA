
load('/fandrhome/matloff/public_html/matloff/public_html/Research/DataSets/ForestCover/CvrSave')
cvr$V14 <- NULL
cvr$V15 <- NULL
cvr$V19 <- NULL
cvr12 <- cvr[cvr$V55 <= 2,c(1:20,52)] 
cvr12 <- as.matrix(cvr12)
nc <- ncol(cvr12)
lng <- length(cvr12[,-nc])
naIdxs <- sample(1:lng,round(0.05*lng)) 
cvr12[,-nc][naIdxs] <- NA 
sum(complete.cases(cvr12))

tstIdxs <- sample(1:nrow(cvr12),10000) 
c12tst <- cvr12[tstIdxs,] 
c12trn <- cvr12[-tstIdxs,] 

c12trn.cc <- c12trn[complete.cases(c12trn),]
lmout <- lm(c12trn.cc[,nc] ~ c12trn.cc[,-nc])

system.time(preds.tower <-
   toweranNA(c12trn.cc[,-nc],lmout$fitted.values,5,c12tst[,-nc],scaleX=F))
# abt 20 mins
mean(round(preds.tower) == c12tst[,nc])  # 0.761

